# Requirements

## 1. 개요

본 시스템은 병원 직원이 MRI 예약을 관리하기 위한 내부 시스템이다.  
직원은 인증 후 예약을 등록, 조회, 취소 및 삭제할 수 있으며,  
모든 주요 행위는 감사 로그로 기록된다.

본 프로젝트는 API 서버를 중심으로 개발하며,  
초기 단계에서는 프론트엔드(UI)는 고려하지 않는다.

---

## 2. 도메인 정의

### 2.1 직원 (Employee)

직원은 시스템에 로그인하여 예약을 관리하는 주체이다.  
직원 정보는 EMR에 등록된 직원 ID(emrId)를 기준으로 관리한다.

#### 주요 속성
- id (PK, 내부 식별자)
- emrId (UNIQUE, EMR 직원 ID)
- name (직원 이름)
- password (암호화된 비밀번호)
- role (권한 역할)
- created_at (생성 시각)

---

### 2.2 예약 (Reservation)

예약은 특정 날짜와 시간에 이루어지는 MRI 예약 정보이다.  
모든 예약은 반드시 한 명의 직원에 의해 등록된다.

직원(Employee) : 예약(Reservation)은 **1:N 관계**이다.

#### 주요 속성
- id (PK)
- employee_id (FK, 예약 등록 직원)

- reservation_date (DATE)
- reservation_time (TIME)

> 날짜 기준 예약 관리 및 시간 슬롯 기반 예약을 지원하기 위해 날짜와 시간을 분리한다.  
> 또한 추후 날짜별/시간별 통계 활용을 고려한다.

- reservation_status (예약 상태)
- treatment_status (진료 상태)

- department (담당과)
- chart_number (차트 번호)
- patient_name (환자 이름)
- direction (방향)
- body_part (부위)
- contrast_used (조영제 여부)
- memo (메모)

- created_at (입력 시간)
- updated_at (수정 시간)

---

## 3. 상태 정의

### 3.1 예약 상태 (Reservation Status)

예약 자체의 상태를 나타낸다.

- BOOKED : 예약 완료
- CANCELED : 예약 취소
- DELETED : 예약 삭제 (논리 삭제, 데이터는 보관)

---

### 3.2 진료 상태 (Treatment Status)

환자의 진료 진행 상태를 나타낸다.

- SURGERY
- OUTPATIENT
- OUTING
- COMPLETED
- BLOCKED
- ETC

> 예약 상태와 진료 상태는 서로 다른 책임과 생명주기를 가지므로 분리하여 관리한다.

---

### 3.3 담당과 (Department)

담당하는 과를 나타낸다.

- OS1
- OS2
- OS3
- ETC

---

### 3.4 권한 역할 (Role)

직원 역할을 나타낸다.

- ADMIN
- USER

> 프로그램 관리자와 일반 사용자를 분리하여 관리한다. 

## 4. 기능 요구사항

### 4.1 직원 관리

- 직원은 회원 가입을 할 수 있다.
- 직원은 emrId와 비밀번호로 로그인한다.
- 로그인하지 않은 사용자는 예약 관련 기능에 접근할 수 없다.

---

### 4.2 예약 관리

- 직원은 **오늘 날짜의 예약 목록을 조회**할 수 있다.
- 직원은 **특정 날짜(과거/미래 포함)**의 예약 목록을 조회할 수 있다.
- 직원은 예약을 신규 등록할 수 있다.
- 직원은 예약을 취소할 수 있다.
- 직원은 예약을 삭제할 수 있다.

> 취소는 예약 상태 변경이며,  
> 삭제는 예약 상태를 DELETED로 변경하는 논리 삭제로 정의한다.

---

## 5. 비기능 요구사항

### 5.1 인증 및 권한

- 모든 예약 관련 기능은 인증된 직원만 사용할 수 있다.

---

### 5.2 감사 로그 (Audit Log)

다음 행위에 대해 감사 로그를 기록한다.

- 로그인 성공 / 실패
- 예약 등록
- 예약 취소
- 예약 삭제

#### 로그에는 다음 정보를 포함한다.
- 행위자(emrId)
- 행위 유형
- 대상 데이터(예약 ID)
- 발생 시각

---

## 6. 기술적 전제

- REST API 서버 기반으로 구현한다.
- 초기 개발 환경에서는 H2 DB를 사용한다.
- DB 스키마는 Flyway로 관리한다.
- ORM은 JPA(Hibernate)를 사용한다.
